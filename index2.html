<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Compare Tool</title>
    <link rel="stylesheet" href="image-compare-viewer.min.css">
    <style>
        body, html {
            height: 100%;
            margin: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
            user-select: none;
            background-color: #f0f0f0;
        }
        .dropdown-container {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 200;
            font-size: 1.2em;
            color: #333;
        }
        .dropdown {
            margin: 0 5px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
            color: #333;
        }
        .zoom-container {
            position: absolute;
            bottom: 10px;
            right: 10px;
            z-index: 200;
            font-size: 1.2em;
            color: #333;
        }
        .zoom-button {
            margin: 0 5px;
            padding: 5px 10px;
            background-color: #fff;
            border: 1px solid #000;
            cursor: pointer;
            border-radius: 3px;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="icv" id="image-compare-container">
        <div class="icv__wrapper">
            <img id="imgA" src="FP_2002.jpg" class="icv__img icv__img-a">
            <img id="imgB" src="FP_2024.jpg" class="icv__img icv__img-b">
        </div>
        <div class="icv__control" id="slider">
            <div class="icv__control-line"></div>
        </div>
        <div class="dropdown-container">
            <label for="dataset">Dataset:</label>
            <select id="dataset" class="dropdown">
                <option value="FP">Forest Park South East</option>
                <option value="BH">Botanical Heights</option>
                <option value="North">North City</option>
                <option value="BR">Bridgeton</option>
            </select>
            <select id="selectA" class="dropdown"></select>
            <select id="selectB" class="dropdown"></select>
        </div>
        <div class="zoom-container">
            <button id="zoom-in" class="zoom-button">Zoom In</button>
            <button id="zoom-out" class="zoom-button">Zoom Out</button>
        </div>
    </div>

    <script src="image-compare-viewer.min.js"></script>
    <script>
        const container = document.getElementById('image-compare-container');
        const imgA = document.getElementById('imgA');
        const imgB = document.getElementById('imgB');
        const selectA = document.getElementById('selectA');
        const selectB = document.getElementById('selectB');
        const dataset = document.getElementById('dataset');
        const zoomInBtn = document.getElementById('zoom-in');
        const zoomOutBtn = document.getElementById('zoom-out');
        const slider = document.getElementById('slider');

        const years = [2002, 2004, 2006, 2008, 2010, 2012, 2014, 2016, 2018, 2020, 2022, 2024];
        let zoomLevel = 1;
        let panX = 0;
        let panY = 0;

        function updateDropdowns(dataset) {
            selectA.innerHTML = years.map(year => `<option value="${dataset}_${year}.jpg">${year}</option>`).join('');
            selectB.innerHTML = years.map(year => `<option value="${dataset}_${year}.jpg" ${year === 2024 ? 'selected' : ''}>${year}</option>`).join('');
            imgA.src = `${dataset}_2002.jpg`;
            imgB.src = `${dataset}_2024.jpg`;
        }

        selectA.addEventListener('change', (e) => {
            imgA.src = e.target.value;
        });

        selectB.addEventListener('change', (e) => {
            imgB.src = e.target.value;
        });

        dataset.addEventListener('change', (e) => {
            updateDropdowns(e.target.value);
        });

        container.addEventListener('wheel', (e) => {
            e.preventDefault();
            zoom(e.clientX, e.clientY, e.deltaY * -0.01);
        });

        zoomInBtn.addEventListener('click', () => {
            zoom(container.offsetWidth / 2, container.offsetHeight / 2, 0.1);
        });

        zoomOutBtn.addEventListener('click', () => {
            zoom(container.offsetWidth / 2, container.offsetHeight / 2, -0.1);
        });

        function zoom(clientX, clientY, delta) {
            const rect = container.getBoundingClientRect();
            const offsetX = clientX - rect.left;
            const offsetY = clientY - rect.top;

            const prevZoomLevel = zoomLevel;
            zoomLevel = Math.min(Math.max(1, zoomLevel + delta), 5);

            const scaleChange = zoomLevel / prevZoomLevel;

            const newOffsetX = offsetX * scaleChange;
            const newOffsetY = offsetY * scaleChange;

            const dx = newOffsetX - offsetX;
            const dy = newOffsetY - offsetY;

            panX -= dx;
            panY -= dy;

            updateTransform();
        }

        function updateTransform() {
            imgA.style.transform = `scale(${zoomLevel}) translate(${panX / zoomLevel}px, ${panY / zoomLevel}px)`;
            imgB.style.transform = `scale(${zoomLevel}) translate(${panX / zoomLevel}px, ${panY / zoomLevel}px)`;
        }

        updateDropdowns('FP');
    </script>
</body>
</html>
